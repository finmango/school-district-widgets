<!-- Chart dependencies -->
<!-- Google Charts -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<!-- CSV Parsing -->
<script type="text/javascript" src="../third_party/papaparse/papaparse.min.js"></script>

<!-- Custom dependencies for data handling -->
<script type="text/javascript" src="../static/data-loader.min.js"></script>

<!-- Configuration loading -->
<script type="text/javascript">CACHE=window.CACHE||{CSV:{},gcharts:{}},DEFAULT_OPTIONS=window.DEFAULT_OPTIONS||{"tcm-metadata-url":"https://storage.googleapis.com/school-districts/school-districts-metadata.csv","cod-data-url":"https://storage.googleapis.com/covid19-open-data/v3","tcm-data-url":"https://storage.googleapis.com/school-districts/cases/latest-school-cases.csv"},CURRENT_OPTIONS=window.CURRENT_OPTIONS||Object.keys(DEFAULT_OPTIONS).reduce((t,o)=>Object.assign(t,{[o]:sessionStorage.getItem(o)||DEFAULT_OPTIONS[o]}),{}),GOOGLE_CHARTS_CONFIG=window.GOOGLE_CHARTS_CONFIG||{theme:"material",colors:["#FB780F"],legend:{position:CURRENT_OPTIONS.chart_legend_position||"none"},chartArea:{width:"100%",height:"100%",left:parseInt(CURRENT_OPTIONS.chart_padding_left||64),bottom:parseInt(CURRENT_OPTIONS.chart_padding_bottom||48),top:parseInt(CURRENT_OPTIONS.chart_padding_top||24)},titlePosition:"in",axisTitlesPosition:"in",hAxis:{textPosition:"bottom"},vAxis:{textPosition:"in",viewWindow:{min:0}},height:parseInt(CURRENT_OPTIONS.chart_height||300)};</script>

<!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <p style="text-align: end; font-size: small;">
    Data from <a href="https://github.com/GoogleCloudPlatform/covid-19-open-data" target="_blank">
        Google's COVID-19 Open Data
    </a>
</p>

    <script async>!async function(){const e=document.createElement("div");document.currentScript.parentElement.prepend(e);const t=await async function(){const e=new URLSearchParams(location.search).get("district_id");return`US_${(await loadCSV(`${CURRENT_OPTIONS["tcm-metadata-url"]}`)).filter(t=>t.district_id===e)[0].state}`}(),a=await loadCSV(`${CURRENT_OPTIONS["cod-data-url"]}/${t}/main.csv`),n=a[0].subregion1_name,r=["search_trends_fever","search_trends_cough","search_trends_common_cold","search_trends_pneumonia"],i=a.filter(e=>r.some(t=>""!==e[t])).map(e=>{const t={Date:e.date};return r.forEach(a=>t[(e=>e.split("_").slice(2).join(" "))(a)]=parseFloat(e[a])),t});await loadGoogleCharts(["corechart"]),new google.visualization.LineChart(e).draw(recordsToDataTable(i),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:`Google Search Trends in ${n}`,curveType:"function",legend:{position:"in"},colors:void 0})),e.parentElement.style.visibility="visible"}();</script>
</div>