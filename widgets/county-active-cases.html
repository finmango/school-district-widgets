<!-- Chart dependencies -->
<!-- Google Charts -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<!-- CSV Parsing -->
<script type="text/javascript" src="../third_party/papaparse/papaparse.min.js"></script>

<!-- Custom dependencies for data handling -->
<script type="text/javascript" src="../static/data-loader.min.js"></script>

<!-- Configuration loading -->
<script type="text/javascript">CACHE=window.CACHE||{CSV:{},gcharts:{}},DEFAULT_OPTIONS=window.DEFAULT_OPTIONS||{"tcm-metadata-url":"https://storage.googleapis.com/school-districts/school-districts-metadata.csv","cod-data-url":"https://storage.googleapis.com/covid19-open-data/v3","tcm-data-url":"https://storage.googleapis.com/school-districts/cases/latest-school-cases.csv"},CURRENT_OPTIONS=window.CURRENT_OPTIONS||Object.keys(DEFAULT_OPTIONS).reduce((s,t)=>Object.assign(s,{[t]:sessionStorage.getItem(t)||DEFAULT_OPTIONS[t]}),{});</script>

<!-- Wrap the whole widget into a DIV -->
<div>
    <script async>!async function(){const t=document.createElement("div");document.currentScript.parentElement.append(t);const i=await async function(){const t=new URLSearchParams(location.search).get("district_id"),i=(await loadCSV(`${CURRENT_OPTIONS["tcm-metadata-url"]}`)).filter(i=>i.district_id===t)[0],a=(await loadCSV("../static/zip-fips-map.csv")).filter(t=>t.zip===i.zip_code)[0].fips;return`US_${i.state}_${a}`}(),a=await loadCSV(`${CURRENT_OPTIONS["cod-data-url"]}/${i}/main.csv`),e=a[0].subregion2_name,o=a.map((t,i)=>{const e=Math.max(0,i-14),o=a.slice(e,i).reduce((t,i)=>t+(parseInt(i.new_confirmed)||0),0);return{Date:t.date,Cases:o}});await loadGoogleCharts(["corechart"]),new google.visualization.ColumnChart(t).draw(recordsToDataTable(o),{title:`Estimated active cases in ${e}`,theme:"material",colors:["#FF9800"],legend:{position:"none"},chartArea:{width:"100%",height:"100%",left:12,bottom:48},titlePosition:"in",axisTitlesPosition:"in",hAxis:{textPosition:"bottom"},vAxis:{textPosition:"in",viewWindow:{min:0}},height:300})}();</script>
</div>